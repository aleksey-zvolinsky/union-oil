inherited frmMoveInstTrans: TfrmMoveInstTrans
  Left = 319
  Top = 199
  Caption = #1060#1086#1088#1084#1080#1088#1086#1074#1072#1085#1080#1077' '#1076#1086#1082#1091#1084#1077#1085#1090#1086#1074' '#1087#1086' '#1089#1084#1072#1088#1090'-'#1082#1072#1088#1090#1072#1084
  ClientHeight = 414
  ClientWidth = 630
  PixelsPerInch = 96
  TextHeight = 13
  inherited Panel1: TPanel
    Top = 381
    Width = 630
    inherited Panel3: TPanel
      Left = 433
    end
    inherited Panel4: TPanel
      inherited bbClear: TBitBtn
        OnClick = bbClearClick
      end
      inherited bbSearch: TBitBtn
        OnClick = bbSearchClick
      end
    end
    inherited pPrint: TPanel
      TabOrder = 9
    end
    inherited pSpeedUp: TPanel
      Left = 420
    end
    inherited pShowDetail: TPanel
      Left = 450
      Width = 74
    end
    object Panel5: TPanel
      Left = 338
      Top = 2
      Width = 82
      Height = 29
      Align = alLeft
      BevelOuter = bvNone
      TabOrder = 5
      object sbPrint: TRxSpeedButton
        Left = 3
        Top = 2
        Width = 45
        Height = 25
        Hint = #1055#1077#1095#1072#1090#1100' '#1089#1086#1087#1091#1090#1089#1090#1074#1091#1102#1097#1080#1093' '#1076#1086#1082#1091#1084#1077#1085#1090#1086#1074
        DropDownMenu = PUM
        Glyph.Data = {
          E6040000424DE604000000000000360000002800000014000000140000000100
          180000000000B004000000000000000000000000000000000000C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0000000000000
          000000000000000000000000000000000000000000000000000000C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0000000C6C6C6C6C6C6C6C6C6C6
          C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6000000C6C6C6000000C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C00000000000000000000000000000000000000000
          00000000000000000000000000000000000000C6C6C6000000C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0000000C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C600FFFF
          00FFFF00FFFFC6C6C6C6C6C6000000000000000000C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0000000C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C684848484848484
          8484C6C6C6C6C6C6000000C6C6C6000000C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          0000000000000000000000000000000000000000000000000000000000000000
          00000000000000C6C6C6C6C6C6000000C0C0C0C0C0C0C0C0C0C0C0C0000000C6
          C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6000000
          C6C6C6000000C6C6C6000000C0C0C0C0C0C0C0C0C0C0C0C0C0C0C00000000000
          00000000000000000000000000000000000000000000000000C6C6C6000000C6
          C6C6000000000000C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0000000FFFFFF
          FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000C6C6C6000000C6C6
          C6000000C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0000000FFFFFF00
          0000000000000000000000000000FFFFFF000000000000000000000000C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0000000FFFFFFFFFFFFFFFF
          FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0000000FFFFFF000000000000
          000000000000000000FFFFFF000000C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0000000FFFFFFFFFFFFFFFFFFFFFFFFFF
          FFFFFFFFFFFFFFFFFFFFFF000000C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C00000000000000000000000000000000000
          00000000000000000000C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
          C0C0C0C0C0C0C0C0C0C0}
      end
      object sbSum: TSpeedButton
        Left = 51
        Top = 2
        Width = 25
        Height = 25
        Hint = #1042#1082#1083'/'#1086#1090#1082#1083'. '#1087#1086#1076#1089#1095#1077#1090' '#1089#1090#1072#1090#1080#1089#1090#1080#1082#1080
        AllowAllUp = True
        GroupIndex = 12
        Glyph.Data = {
          76010000424D7601000000000000760000002800000020000000100000000100
          0400000000000001000000000000000000001000000010000000000000000000
          800000800000008080008000000080008000808000007F7F7F00BFBFBF000000
          FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF00333333333333
          333333333333333333333333333333333333333FFFFFFFFFFF33330000000000
          03333377777777777F33333003333330033333377FF333377F33333300333333
          0333333377FF33337F3333333003333303333333377FF3337333333333003333
          333333333377FF3333333333333003333333333333377FF33333333333330033
          3333333333337733333333333330033333333333333773333333333333003333
          33333333337733333F3333333003333303333333377333337F33333300333333
          03333333773333337F33333003333330033333377FFFFFF77F33330000000000
          0333337777777777733333333333333333333333333333333333}
        NumGlyphs = 2
        OnClick = sbSumClick
      end
    end
  end
  inherited Panel2: TPanel
    Width = 630
    Height = 79
    object lTo: TLabel
      Left = 7
      Top = 38
      Width = 18
      Height = 13
      Caption = #1087#1086' :'
    end
    object lFrom: TLabel
      Left = 7
      Top = 3
      Width = 41
      Height = 13
      Caption = #1044#1072#1090#1072' '#1089' :'
    end
    object Label1: TLabel
      Left = 408
      Top = 3
      Width = 74
      Height = 13
      Caption = #8470' '#1076#1086#1082#1091#1084#1077#1085#1090#1072' :'
    end
    object sbClear: TSpeedButton
      Left = 375
      Top = 17
      Width = 21
      Height = 21
      Hint = '21'
      Flat = True
      Glyph.Data = {
        76010000424D7601000000000000760000002800000020000000100000000100
        0400000000000001000000000000000000001000000010000000000000000000
        80000080000000808000800000008000800080800000C0C0C000808080000000
        FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF00DDDDDDDDDDDD
        DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD88DDDDDDDD
        88DDDDFFDDDDDDDDFFDDDD888DDDDDD888DDDDFFFDDDDDDFFFDDDDD888DDDD88
        8DDDDDDFFFDDDDFFFDDDDDDD888DD888DDDDDDDDFFFDDFFFDDDDDDDDD888888D
        DDDDDDDDDFFFFFFDDDDDDDDDDD8888DDDDDDDDDDDDFFFFDDDDDDDDDDDD8888DD
        DDDDDDDDDDFFFFDDDDDDDDDDD888888DDDDDDDDDDFFFFFFDDDDDDDDD888DD888
        DDDDDDDDFFFDDFFFDDDDDDD888DDDD888DDDDDDFFFDDDDFFFDDDDD888DDDDDD8
        88DDDDFFFDDDDDDFFFDDDD88DDDDDDDD88DDDDFFDDDDDDDDFFDDDDDDDDDDDDDD
        DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD}
      NumGlyphs = 2
      OnClick = sbClearClick
    end
    object Label2: TLabel
      Left = 139
      Top = 3
      Width = 42
      Height = 13
      Caption = #1050#1083#1080#1077#1085#1090' :'
    end
    object Label3: TLabel
      Left = 408
      Top = 38
      Width = 89
      Height = 13
      Caption = #1044#1072#1090#1072' '#1076#1086#1082#1091#1084#1077#1085#1090#1072' :'
    end
    object sbDocTypeClear: TSpeedButton
      Left = 375
      Top = 52
      Width = 21
      Height = 21
      Hint = '21'
      Flat = True
      Glyph.Data = {
        76010000424D7601000000000000760000002800000020000000100000000100
        0400000000000001000000000000000000001000000010000000000000000000
        80000080000000808000800000008000800080800000C0C0C000808080000000
        FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF00DDDDDDDDDDDD
        DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD88DDDDDDDD
        88DDDDFFDDDDDDDDFFDDDD888DDDDDD888DDDDFFFDDDDDDFFFDDDDD888DDDD88
        8DDDDDDFFFDDDDFFFDDDDDDD888DD888DDDDDDDDFFFDDFFFDDDDDDDDD888888D
        DDDDDDDDDFFFFFFDDDDDDDDDDD8888DDDDDDDDDDDDFFFFDDDDDDDDDDDD8888DD
        DDDDDDDDDDFFFFDDDDDDDDDDD888888DDDDDDDDDDFFFFFFDDDDDDDDD888DD888
        DDDDDDDDFFFDDFFFDDDDDDD888DDDD888DDDDDDFFFDDDDFFFDDDDD888DDDDDD8
        88DDDDFFFDDDDDDFFFDDDD88DDDDDDDD88DDDDFFDDDDDDDDFFDDDDDDDDDDDDDD
        DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD}
      NumGlyphs = 2
      OnClick = sbDocTypeClearClick
    end
    object Label4: TLabel
      Left = 139
      Top = 38
      Width = 82
      Height = 13
      Caption = #1058#1080#1087' '#1076#1086#1082#1091#1084#1077#1085#1090#1072' :'
    end
    object sbDocDateClear: TSpeedButton
      Left = 523
      Top = 52
      Width = 21
      Height = 21
      Hint = '21'
      Flat = True
      Glyph.Data = {
        76010000424D7601000000000000760000002800000020000000100000000100
        0400000000000001000000000000000000001000000010000000000000000000
        80000080000000808000800000008000800080800000C0C0C000808080000000
        FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF00DDDDDDDDDDDD
        DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD88DDDDDDDD
        88DDDDFFDDDDDDDDFFDDDD888DDDDDD888DDDDFFFDDDDDDFFFDDDDD888DDDD88
        8DDDDDDFFFDDDDFFFDDDDDDD888DD888DDDDDDDDFFFDDFFFDDDDDDDDD888888D
        DDDDDDDDDFFFFFFDDDDDDDDDDD8888DDDDDDDDDDDDFFFFDDDDDDDDDDDD8888DD
        DDDDDDDDDDFFFFDDDDDDDDDDD888888DDDDDDDDDDFFFFFFDDDDDDDDD888DD888
        DDDDDDDDFFFDDFFFDDDDDDD888DDDD888DDDDDDFFFDDDDFFFDDDDD888DDDDDD8
        88DDDDFFFDDDDDDFFFDDDD88DDDDDDDD88DDDDFFDDDDDDDDFFDDDDDDDDDDDDDD
        DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD}
      NumGlyphs = 2
      OnClick = sbDocDateClearClick
    end
    object deFrom: TDateEdit
      Left = 7
      Top = 17
      Width = 121
      Height = 21
      DefaultToday = True
      NumGlyphs = 2
      TabOrder = 0
      OnAcceptDate = deFromAcceptDate
    end
    object deTo: TDateEdit
      Left = 7
      Top = 52
      Width = 121
      Height = 21
      DefaultToday = True
      NumGlyphs = 2
      TabOrder = 1
      OnAcceptDate = deToAcceptDate
    end
    object edDocNum: TEdit
      Left = 408
      Top = 17
      Width = 113
      Height = 21
      TabOrder = 4
    end
    object ceTo: TComboEdit
      Left = 139
      Top = 17
      Width = 234
      Height = 21
      DirectInput = False
      GlyphKind = gkDropDown
      NumGlyphs = 1
      TabOrder = 2
      OnButtonClick = ceToButtonClick
      OnDblClick = ceToButtonClick
    end
    object deDocDate: TDateEdit
      Left = 408
      Top = 52
      Width = 113
      Height = 21
      DirectInput = False
      NumGlyphs = 2
      TabOrder = 5
    end
    object cedDocType: TComboEdit
      Left = 139
      Top = 52
      Width = 234
      Height = 21
      DirectInput = False
      GlyphKind = gkDropDown
      NumGlyphs = 1
      TabOrder = 3
      OnButtonClick = cedDocTypeButtonClick
      OnDblClick = cedDocTypeButtonClick
    end
  end
  inherited pBase: TPanel
    Top = 89
    Width = 480
    Height = 292
    inherited SplitterDetail: TSplitter
      Top = 237
      Width = 480
    end
    inherited DBGrid1: TDBGridEh
      Width = 480
      Height = 237
      Options = [dgTitles, dgColumnResize, dgColLines, dgRowLines, dgTabs, dgRowSelect, dgAlwaysShowSelection, dgConfirmDelete, dgCancelOnExit]
      OptionsEh = [dghFixed3D, dghHighlightFocus, dghAutoSortMarking]
      RowHeight = 30
      SumList.Active = True
      TitleHeight = 40
      Columns = <
        item
          EditButtons = <>
          FieldName = 'CNT'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #1050'-'#1074#1086' '#1089#1090#1088#1086#1082
          Width = 47
        end
        item
          EditButtons = <>
          FieldName = 'DOC_NAME'
          Footers = <
            item
              Alignment = taRightJustify
              Value = #1050#1086#1083'-'#1074#1086' '#1076#1086#1082#1091#1084#1077#1085#1090#1086#1074':'
              ValueType = fvtStaticText
            end>
          Title.Alignment = taCenter
          Title.Caption = #1058#1080#1087' '#1076#1086#1082#1091#1084#1077#1085#1090#1072
          Width = 146
        end
        item
          EditButtons = <>
          FieldName = 'DATE_'
          Footers = <
            item
              FieldName = 'DATE_'
              ValueType = fvtCount
            end>
          Title.Alignment = taCenter
          Title.Caption = #1044#1072#1090#1072
          Width = 69
        end
        item
          EditButtons = <>
          FieldName = 'TO_NAME'
          Footers = <
            item
              Alignment = taRightJustify
              Value = #1042#1089#1077#1075#1086', '#1083':'
              ValueType = fvtStaticText
            end>
          Title.Alignment = taCenter
          Title.Caption = #1050#1083#1080#1077#1085#1090
          Width = 197
        end
        item
          EditButtons = <>
          FieldName = 'DOC_NUMBER'
          Footers = <
            item
              FieldName = 'LITR'
              ValueType = fvtSum
            end>
          Title.Alignment = taCenter
          Title.Caption = #1053#1086#1084#1077#1088' '#1076#1086#1082#1091#1084#1077#1085#1090#1072
          Width = 60
        end
        item
          EditButtons = <>
          FieldName = 'DOC_DATE'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #1044#1072#1090#1072' '#1076#1086#1082#1091#1084#1077#1085#1090#1072
        end
        item
          EditButtons = <>
          FieldName = 'R_DOC_NUMBER'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #1053#1086#1084#1077#1088' '#1087#1077#1088#1074#1080#1095#1085#1086#1075#1086' '#1076#1086#1082#1091#1084#1077#1085#1090#1072
          Width = 67
        end
        item
          EditButtons = <>
          FieldName = 'R_DOC_DATE'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #1044#1072#1090#1072' '#1087#1077#1088#1074#1080#1095#1085#1086#1075#1086' '#1076#1086#1082#1091#1084#1077#1085#1090#1072
          Width = 65
        end
        item
          EditButtons = <>
          FieldName = 'LITR'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #1050'-'#1074#1086', '#1083
          Width = 43
        end
        item
          EditButtons = <>
          FieldName = 'SUMNDS_POP'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #1057#1091#1084#1084#1072','#1075#1088#1085' ('#1094'.'#1087#1086#1087#1086#1083#1085')'
          Width = 58
        end
        item
          EditButtons = <>
          FieldName = 'SUMNDS_TERM'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #1057#1091#1084#1084#1072','#1075#1088#1085' ('#1094'.'#1090#1077#1088#1084')'
          Width = 59
        end>
    end
    inherited pDetail: TPanel
      Top = 240
      Width = 480
      inherited DBGridDetail: TDBGridEh
        Width = 480
      end
    end
  end
  inherited pnlHideFilter: TPanel
    Width = 630
    inherited pnlTuneGridBtn: TPanel
      Left = 601
    end
  end
  inherited PanelCol: TPanel
    Left = 480
    Top = 89
    Height = 292
    inherited cbCol: TRxCheckListBox
      Height = 264
      Align = alRight
    end
    inherited pRefresh: TPanel
      Top = 266
    end
  end
  inherited ds: TOraDataSource
    OnDataChange = dsDataChange
    Left = 110
    Top = 250
  end
  inherited q: TOilQuery
    SQL.Strings = (
      'select count(*) as cnt,'
      '       doc_type,'
      '       doc_name,'
      
        '       decode(:DocType, 5, trunc(add_months(date_,1),'#39'MM'#39')-1, de' +
        'code(ov.GetVal('#39'GENERATION'#39'),'#39'2'#39',trunc(add_months(date_,1),'#39'MM'#39')' +
        '-1,date_)) as date_,'
      
        '       decode(:DocType,5,to_char(null),doc_number) as doc_number' +
        ','
      '       decode(:DocType,5,to_date(null),doc_date) as doc_date,'
      
        '       decode(ov.GetVal('#39'GENERATION'#39'),'#39'2'#39',null,decode(doc_type, ' +
        '1, r_doc_number, 2, r_doc_number, null)) as r_doc_number, '
      
        '       decode(ov.GetVal('#39'GENERATION'#39'),'#39'2'#39',to_date(null),decode(d' +
        'oc_type, 1, r_doc_date, 2, r_doc_date, to_date(null))) as r_doc_' +
        'date,'
      '       sum(litr) as litr,'
      '       decode(doc_type, 1, to_id, 2, to_id, null) as to_id,'
      
        '       decode(doc_type, 1, to_inst, 2, to_inst, null) as to_inst' +
        ','
      
        '       decode(doc_type, 1, to_name, 2, to_name, null) as to_name' +
        ','
      '       sum(sumnds_pop) as sumnds_pop,'
      '       sum(sumnds_term) as sumnds_term'
      '  from v_card_rn_data'
      ' where date_ between :BeginDate and :EndDate'
      
        '   and (decode(doc_type, 1, to_id, 2, to_id, null) = :OrgId or :' +
        'OrgId = 0)'
      
        '   and (decode(doc_type, 1, to_inst, 2, to_inst, null) = :OrgIns' +
        't or :OrgInst = 0)'
      
        '   and (doc_number like  '#39'%'#39' || :DocNum || '#39'%'#39' or :DocNum is nul' +
        'l)'
      '   and (doc_type = :DocType or :DocType = 0)'
      '   and (doc_date = :DocDate or :DocDate is null)'
      ' group by'
      '  doc_type,'
      '  doc_name,'
      
        '  decode(:DocType, 5, trunc(add_months(date_,1),'#39'MM'#39')-1, decode(' +
        'ov.GetVal('#39'GENERATION'#39'),'#39'2'#39',trunc(add_months(date_,1),'#39'MM'#39')-1,da' +
        'te_)),'
      '  decode(:DocType, 5, to_char(null), doc_number),'
      '  decode(:DocType, 5, to_date(null), doc_date),'
      
        '  decode(ov.GetVal('#39'GENERATION'#39'),'#39'2'#39',null,decode(doc_type, 1, r_' +
        'doc_number, 2, r_doc_number, null)), '
      
        '  decode(ov.GetVal('#39'GENERATION'#39'),'#39'2'#39',to_date(null),decode(doc_ty' +
        'pe, 1, r_doc_date, 2, r_doc_date, to_date(null))),'
      '  decode(doc_type, 1, to_id, 2, to_id, null),'
      '  decode(doc_type, 1, to_inst, 2, to_inst, null),'
      '  decode(doc_type, 1, to_name, 2, to_name, null)'
      'order by date_ desc, doc_name')
    Left = 110
    Top = 194
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'DocType'
      end
      item
        DataType = ftUnknown
        Name = 'BeginDate'
      end
      item
        DataType = ftUnknown
        Name = 'EndDate'
      end
      item
        DataType = ftUnknown
        Name = 'OrgId'
      end
      item
        DataType = ftUnknown
        Name = 'OrgInst'
      end
      item
        DataType = ftUnknown
        Name = 'DocNum'
      end
      item
        DataType = ftUnknown
        Name = 'DocDate'
      end>
    object qDOC_TYPE: TFloatField
      FieldName = 'DOC_TYPE'
    end
    object qDOC_NAME: TStringField
      FieldName = 'DOC_NAME'
      Size = 42
    end
    object qDATE_: TDateTimeField
      FieldName = 'DATE_'
    end
    object qDOC_NUMBER: TStringField
      FieldName = 'DOC_NUMBER'
    end
    object qDOC_DATE: TDateTimeField
      FieldName = 'DOC_DATE'
    end
    object qR_DOC_NUMBER: TStringField
      FieldName = 'R_DOC_NUMBER'
      Size = 15
    end
    object qR_DOC_DATE: TDateTimeField
      FieldName = 'R_DOC_DATE'
    end
    object qLITR: TFloatField
      FieldName = 'LITR'
    end
    object qTO_NAME: TStringField
      FieldName = 'TO_NAME'
      Size = 100
    end
    object qSUMNDS_POP: TFloatField
      FieldName = 'SUMNDS_POP'
    end
    object qSUMNDS_TERM: TFloatField
      FieldName = 'SUMNDS_TERM'
    end
    object qTO_ID: TFloatField
      FieldName = 'TO_ID'
    end
    object qTO_INST: TFloatField
      FieldName = 'TO_INST'
    end
    object qCNT: TFloatField
      FieldName = 'CNT'
    end
  end
  inherited ADMQ: TOilQuery
    Top = 246
  end
  inherited PUM: TPopupMenu
    Left = 106
    Top = 335
    object miPrintByPeriodPart: TMenuItem [0]
      Caption = #1055#1077#1095#1072#1090#1100'(c '#1087#1072#1088#1090#1080#1077#1081')'
      OnClick = miPrintByPeriodClick
    end
    object miCardsAvias: TMenuItem [1]
      Caption = #1055#1072#1082#1077#1090' '#1076#1086#1082#1091#1084#1077#1085#1090#1110#1074' '#1076#1083#1103' '#1040#1074#1110#1072#1089#1072
      Visible = False
      OnClick = miCardsAviasClick
    end
    object miPrintByPeriod: TMenuItem [2]
      Caption = #1055#1077#1095#1072#1090#1100
      OnClick = miPrintByPeriodClick
    end
    object N2: TMenuItem [3]
      Caption = #1059#1076#1072#1083#1080#1090#1100' '#1076#1086#1082#1091#1084#1077#1085#1090
      OnClick = N2Click
    end
    object N1: TMenuItem [4]
      Caption = '-'
    end
  end
  inherited ActionList: TActionList
    Left = 261
  end
  object qryRN: TOilQuery
    SQL.Strings = (
      'select'
      '  decode(doc_type,1,'
      '    decode('
      
        '      count(distinct r_doc_date) over (partition by date_,to_id,' +
        'to_inst, doc_type ),'
      '      1,'
      '      null,'
      '      '#39'/'#39'||r_doc_number'
      '    )'
      '  ) as rn_num_add,'
      '  ct.*,'
      '  decode(ct.doc_number, null, '#39'!'#39' , ct.doc_number) as new_rn'
      'from v_card_rn_data ct'
      'where date_ between :BeginDate and :EndDate'
      
        'and (decode(doc_type, 1, to_id, 2, to_id, null) = :OrgId or :Org' +
        'Id = 0)'
      
        'and (decode(doc_type, 1, to_inst, 2, to_inst, null) = :OrgInst o' +
        'r :OrgInst = 0)'
      'and (doc_number like  '#39'%'#39' || :DocNum || '#39'%'#39' or :DocNum is null)'
      'and (doc_type = :DocType or :DocType = 0)'
      'and (doc_date = :DocDate or :DocDate is null)'
      'order by new_rn desc, ct.doc_type, date_,'
      '  decode(doc_type, 1, to_id, 2, to_id, null), '
      '  decode(doc_type, 1, to_inst, 2, to_inst, null),'
      '  r_doc_number, r_doc_date, npg_id, card_number,'
      '  ct.azs_par_name, azs_name')
    FetchAll = True
    RequestLive = False
    UpdateMode = upWhereAll
    Left = 50
    Top = 175
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'BeginDate'
      end
      item
        DataType = ftUnknown
        Name = 'EndDate'
      end
      item
        DataType = ftUnknown
        Name = 'OrgId'
      end
      item
        DataType = ftUnknown
        Name = 'OrgInst'
      end
      item
        DataType = ftUnknown
        Name = 'DocNum'
      end
      item
        DataType = ftUnknown
        Name = 'DocType'
      end
      item
        DataType = ftUnknown
        Name = 'DocDate'
      end>
  end
  object qryNN: TOilQuery
    SQL.Strings = (
      'select date_, np_type, term_price,'
      
        '       decode(sum(rn_litr), 0, sum(nvl(tr_litr, 0)), sum(rn_litr' +
        ')) as tr_litr,'
      
        '       decode(sum(rn_amount), 0, sum(nvl(tr_amount, 0)), sum(rn_' +
        'amount)) as tr_amount,'
      
        '       decode(rn_obl_num, null, -1, rn_obl_num) as new_nn, sb.nn' +
        '_num'
      '  from (select ct.date_, ct.np_type, ct.term_price,'
      
        '                sum(ct.amount) as tr_amount, sum(ct.litr) as tr_' +
        'litr,'
      
        '                decode(rn_obl_num, null, 0, sum(ct.litr)) as rn_' +
        'litr,'
      
        '                decode(rn_obl_num, null, 0, sum(ct.amount)) as r' +
        'n_amount,'
      '                rn_obl_num'
      '           from v_card_move_inst ct, v_org oo'
      '          where ct.date_ between :FromDate and :ToDate'
      '            and ct.CardAlign = 1 - :move_type'
      '            and oo.id = oo.inst'
      '            and oo.inst = emitent_id'
      '            and (decode(oo.org_type, 4, emitent_id, oo.par) ='
      '                ov.getval('#39'inst_old'#39') and :move_type = 1 or'
      '                decode(oo.org_type, 4, emitent_id, oo.par) <>'
      '                ov.getval('#39'inst_old'#39') and :move_type = 0)'
      
        '          group by ct.date_, ct.np_type, ct.term_price, rn_obl_n' +
        'um) tr,'
      
        '       (select sb.s_date, sbd.nds_t as nn_amount, sbd.kol as nn_' +
        'litr,'
      
        '                sb.Num as nn_num, sbd.tov_id, sbd.price_nds as p' +
        'rice, nal_t'
      '           from oil_sale_book sb, oil_sale_book_det sbd'
      '          where sb.inst=ov.GetVal('#39'INST'#39')'
      '            and sb.id = sbd.nn_id(+)'
      '            and sb.inst = sbd.nn_inst(+)'
      '            and sb.state = '#39'Y'#39
      '            and sbd.state(+) = sb.state'
      '            and sb.nn_cause_id = 8'
      '            and sb.nal_t = 701'
      '            and organ = organ_inst'
      '            and s_date between :FromDate and :ToDate) sb'
      ' where 1 = 1'
      '   and sb.s_date(+) = trunc(tr.date_)'
      '   and sb.tov_id(+) = tr.np_type'
      '   and sb.nn_litr(+) = tr.tr_litr'
      '   and sb.price(+) = tr.term_price'
      ' group by date_, np_type, term_price, rn_obl_num, sb.nn_num'
      ' order by date_ asc, new_nn desc, np_type')
    FetchAll = True
    RequestLive = False
    UpdateMode = upWhereAll
    Left = 10
    Top = 175
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'FromDate'
      end
      item
        DataType = ftUnknown
        Name = 'ToDate'
      end
      item
        DataType = ftUnknown
        Name = 'move_type'
      end>
  end
  object qDog: TOilQuery
    Session = frmStart.OraSession1
    SQL.Strings = (
      'select id,inst,dog,dog_date'
      'from '
      '  (select dog.*,'
      '     row_number() over (order by dog_date,id) rnum'
      '   from oil_dog dog'
      '   where state='#39'Y'#39' and dog_type='#39'K'#39
      '     and from_=:FromId'
      '     and from_inst=:FromInst'
      '     and to_=:ToId'
      '     and to_inst=:ToInst'
      '  )'
      'where rnum=1')
    RequestLive = False
    UpdateMode = upWhereAll
    Left = 304
    Top = 216
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'FromId'
      end
      item
        DataType = ftUnknown
        Name = 'FromInst'
      end
      item
        DataType = ftUnknown
        Name = 'ToId'
      end
      item
        DataType = ftUnknown
        Name = 'ToInst'
      end>
  end
  object qWork: TOilQuery
        RequestLive = False
    UpdateMode = upWhereAll
    Left = 384
    Top = 221
  end
  object qryRNPart: TOilQuery
    SQL.Strings = (
      'select'
      '  decode(doc_type,1,'
      '    decode('
      
        '      count(distinct r_doc_date) over (partition by date_,to_id,' +
        'to_inst, doc_type ),'
      '      1,'
      '      null,'
      '      '#39'/'#39'||r_doc_number'
      '    )'
      '  ) as rn_num_add,'
      '  ct.*,'
      '  decode(ct.doc_number, null, '#39'!'#39' , ct.doc_number) as new_rn  '
      'from v_card_rn_data_sr ct'
      'where  date_ between :BeginDate and :EndDate'
      
        'and (decode(doc_type, 1, to_id, 2, to_id, null) = :OrgId or :Org' +
        'Id = 0)'
      
        'and (decode(doc_type, 1, to_inst, 2, to_inst, null) = :OrgInst o' +
        'r :OrgInst = 0)'
      'and (doc_number like  '#39'%'#39' || :DocNum || '#39'%'#39' or :DocNum is null)'
      'and (doc_type = :DocType or :DocType = 0)'
      'and (doc_date = :DocDate or :DocDate is null)'
      'order by new_rn desc, ct.doc_type, date_,'
      '  decode(doc_type, 1, to_id, 2, to_id, null), '
      '  decode(doc_type, 1, to_inst, 2, to_inst, null),'
      '  r_doc_number, r_doc_date,   card_number, '
      '  ct.azs_par_name, azs_name')
    FetchAll = True
    RequestLive = False
    UpdateMode = upWhereAll
    Left = 50
    Top = 223
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'BeginDate'
      end
      item
        DataType = ftUnknown
        Name = 'EndDate'
      end
      item
        DataType = ftUnknown
        Name = 'OrgId'
      end
      item
        DataType = ftUnknown
        Name = 'OrgInst'
      end
      item
        DataType = ftUnknown
        Name = 'DocNum'
      end
      item
        DataType = ftUnknown
        Name = 'DocType'
      end
      item
        DataType = ftUnknown
        Name = 'DocDate'
      end>
  end
  object qRnAvias: TOilQuery
    SQL.Strings = (
      'select'
      '  trunc(add_months(ct.date_,1),'#39'MM'#39')-1 as date_,'
      '  npg.fullname as np_group_full,'
      '  dim.name as dim_name,'
      '  npg.petrol_id,'
      '  sum(ct.litr) as litr,'
      '  '
      
        '  nvl(NDS.GetNoNDS_WithNDS(ov.GetNpgPrice(npg.id),to_date(:EndDa' +
        'te)),'
      '      round(sum(ct.sumnonds_term)/sum(ct.litr),2)) as PriceXnds,'
      '  nvl(ov.GetNpgPrice(npg.id),'
      '      round(sum(ct.sumnds_term)/sum(ct.litr),2)) as PriceNds,'
      '      '
      '  nvl(round(ov.GetNpgPrice(npg.id)*sum(ct.litr),2),'
      '      sum(ct.sumnds_term)) as SumNds,'
      
        '  NDS.GetNoNDS_WithNDS(nvl(round(ov.GetNpgPrice(npg.id)*sum(ct.l' +
        'itr),2),'
      '      sum(ct.sumnds_term)),to_date(:EndDate)) as SumXnds,'
      
        '  NDS.GetNDS_WithNDS(nvl(round(ov.GetNpgPrice(npg.id)*sum(ct.lit' +
        'r),2),'
      '      sum(ct.sumnds_term)),to_date(:EndDate)) as Nds'
      ' from v_card_rn_data ct, v_oil_np_group npg, v_oil_dimension dim'
      'where date_ between :BeginDate and :EndDate'
      '  and doc_type = 5'
      '  and dim.id = 28'
      '  and npg.id = ct.npg_id'
      'group by trunc(add_months(ct.date_,1),'#39'MM'#39')-1,'
      '         npg.petrol_id,'
      '         npg.id,'
      '         npg.fullname,'
      '         dim.name'
      
        'order by decode(petrol_id, 4,10, 5,20, 6,30, 9,40, 7,50, 3,60, 8' +
        ',70, 100)')
    RequestLive = False
    UpdateMode = upWhereAll
    Left = 200
    Top = 277
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'EndDate'
      end
      item
        DataType = ftUnknown
        Name = 'BeginDate'
      end>
  end
  object qReestrAvias: TOilQuery
    SQL.Strings = (
      
        'select row_number() over (order by ct.np_name, ct.card_number) a' +
        's por_number,'
      '       ct.np_name,'
      '       ct.azs_par_name||'#39' '#39'||ct.azs_name as from_name,'
      '       ct.card_number,'
      '       ct.checknum,'
      '       ct.date_,'
      '       dim.name as dim_name,'
      '       ct.litr,'
      '       ct.pricenonds_term as PriceXnds,'
      '       ct.sumnonds_term as SummXnds,'
      '       ct.nds_term as Nds,'
      '       ct.sumnds_term as SummNds'
      '  from v_card_rn_data ct, v_oil_dimension dim'
      ' where date_ between :BeginDate and :EndDate'
      '   and doc_type = 5'
      '   and dim.id = 28'
      
        'order by decode(npg_id, 4,10, 6,20, 7,30, 76,40, 10,50, 3,60, 62' +
        ',70, 100), ct.date_, ct.card_number')
    RequestLive = False
    UpdateMode = upWhereAll
    Left = 256
    Top = 277
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'BeginDate'
      end
      item
        DataType = ftUnknown
        Name = 'EndDate'
      end>
  end
  object dsCardGetPrice: TOraDataSource
    DataSet = qCardGetPrice
    Left = 528
    Top = 173
  end
  object qCardGetPrice: TOilQuery
    SQLUpdate.Strings = (
      'update faketable set fakefield = fakefield')
    SQL.Strings = (
      'select'
      '  npg.fullname as np_group_full,'
      '  npg.id as np_group_id,'
      '  sum(ct.litr) as litr,'
      '  round(sum(ct.sumnds_term)/sum(ct.litr),4) as Price,'
      '  sum(ct.sumnds_term) as Summ'
      ' from v_card_rn_data ct, v_oil_np_group npg'
      'where date_ between :BeginDate and :EndDate'
      '  and oil_inst= :obl_id'
      '  and doc_type = 5'
      '  and ct.npg_id = npg.id'
      'group by npg.fullname,'
      '         npg.id,'
      '         npg.petrol_id'
      
        'order by decode(petrol_id, 4,10, 5,20, 6,30, 9,40, 7,50, 3,60, 8' +
        ',70, 100)')
    FetchAll = True
    CachedUpdates = True
    AutoCommit = False
    OnCalcFields = qCardGetPriceCalcFields
        RequestLive = False
    UpdateMode = upWhereAll
    Left = 520
    Top = 182
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'BeginDate'
      end
      item
        DataType = ftUnknown
        Name = 'EndDate'
      end
      item
        DataType = ftUnknown
        Name = 'obl_id'
      end>
    object qCardGetPriceNP_GROUP_FULL: TStringField
      DisplayLabel = #1043#1088#1091#1087#1072' '#1053#1055
      FieldName = 'NP_GROUP_FULL'
      ReadOnly = True
      Size = 50
    end
    object qCardGetPriceNP_GROUP_ID: TFloatField
      DisplayLabel = 'npg_id'
      FieldName = 'NP_GROUP_ID'
      ReadOnly = True
    end
    object qCardGetPriceLITR: TFloatField
      DisplayLabel = #1051#1110#1090#1088#1080
      FieldName = 'LITR'
      ReadOnly = True
    end
    object qCardGetPricePRICE: TFloatField
      DisplayLabel = #1062#1110#1085#1072' '#1079' '#1055#1044#1042
      FieldName = 'PRICE'
      DisplayFormat = '0.#####'
    end
    object qCardGetPriceSumNds: TFloatField
      DisplayLabel = #1057#1091#1084#1072' '#1079' '#1055#1044#1042
      FieldKind = fkCalculated
      FieldName = 'SumNds'
      DisplayFormat = '0.##'
      Calculated = True
    end
  end
  object qDogFil: TOilQuery
    SQL.Strings = (
      'select id,inst,dog,dog_date'
      'from '
      '  (select dog.*,'
      '     row_number() over (order by dog_date,id) rnum'
      '   from oil_dog dog'
      '   where state='#39'Y'#39' and dog_type='#39'K'#39
      '     and from_=:From_id'
      '     and from_inst=:From_id'
      '     and to_=:To_id'
      '     and to_inst=:To_id'
      '     and dog_date between :FromDate and :ToDate'
      '  )'
      'where rnum=1')
    RequestLive = False
    UpdateMode = upWhereAll
    Left = 308
    Top = 276
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'From_id'
      end
      item
        DataType = ftUnknown
        Name = 'To_id'
      end
      item
        DataType = ftUnknown
        Name = 'FromDate'
      end
      item
        DataType = ftUnknown
        Name = 'ToDate'
      end>
  end
  object qNNFil: TOilQuery
    Session = frmStart.OraSession1
    SQL.Strings = (
      'select'
      '       sb.s_date as date_,'
      '       sb.id,'
      '       sb.inst,'
      '       npg.fullname as tov_full,'
      '       npg.id as tov_id,'
      '       sbd.nds_t as sumnds,'
      '       price_nds,'
      '       sbd.kol as co'
      '  from oil_sale_book sb,'
      '       oil_sale_book_det sbd,'
      '       v_oil_np_group npg'
      ' where sb.state='#39'Y'#39' and sbd.state='#39'Y'#39
      '   and sbd.nn_id=sb.id and sbd.nn_inst=sb.inst'
      '   and sbd.tov_id=npg.id'
      '   and sb.nn_cause_id = 8'
      '   and sb.s_date = :Date_'
      '   and sb.organ=:to_id    '
      '   and sb.from_=:from_id '
      '   and sb.from_inst=sb.from_'
      '   and sb.organ=sb.organ_inst'
      
        'order by decode(npg.petrol_id, 4,10, 5,20, 6,30, 9,40, 7,50, 3,6' +
        '0, 8,70, 100)')
    RequestLive = False
    UpdateMode = upWhereAll
    Left = 352
    Top = 277
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'Date_'
      end
      item
        DataType = ftUnknown
        Name = 'to_id'
      end
      item
        DataType = ftUnknown
        Name = 'from_id'
      end>
  end
end
